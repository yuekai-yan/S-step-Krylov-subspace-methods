# Notes – October 7, 2025
 
**Topic:** Discussion on Experimental Results of RBGS_GMRES, BGS_GMRES and built-in GMRES  

---


## 1. Overview of Experiment Setup

| Parameter | Description |
|------------|-------------|
| Solver | RBGS-GMRES, BGS-GMRES, GMRES(built-in)|
| Runs | 1 |
| Matrices Tested | A1, A2, A3, A4 |
| Sketch Sizes | s = 1, 5, 10, 20|
| Metric | Relative residual, $ \left\lVert A*Qy - b \right\rVert $ |

---

## 2. Experimental Results by Matrix

---

### 2.1 Matrix A1 – Nonsymmetric matrix

**Matrix info:** \( n = 2500, alpha = 0.5, lambda = logspace(0,-5,n).'\)  
**Sketch info:** \( m = 501, d = 2 * m )  
**Converge info:** \( ctol = 1e-8)

#### ➤ Results for Step Sizes

**relative residual**
- s=1 ![s=1](fig/A1_relErr_iter_CI_s1.png) | residual after reorthogonalization ![s=5, reorthogonality](fig/A1_relErr_iter_CI_s1_m501_reorth.png)
- s=5 ![s=5](fig/A1_relErr_iter_CI_s5_m501.png) | esidual after reorthogonalization ![s=5, reorthogonality](fig/A1_relErr_iter_CI_s5_m501_reorth.png)
- s=10 ![s=10](fig/A1_relErr_iter_CI_s10_m501.png) | residual after reorthogonalization ![s=10, reorthogonality](fig/A1_relErr_iter_CI_s10_m501_reorth.png)
- s=20 ![s=20](fig/A1_relErr_iter_CI_s20_m501.png) |residual after reorthogonalization ![s=20, reorthogonality](fig/A1_relErr_iter_CI_s20_m501_reorth.png)


**Discussion:**
- In the implementation, m = 501 is fixed
- When s = 1, BGS_GMRES and built-in GMRES coincide, showing that BGS_GMRES is fine in implementation
- RBGS_GMRES divergences in each case
- When s increases, BGS_GMRES begins to converge, and when s = 20, BGS even detects convergence after 340 steps
- It seems that when s=10, the residual does not conform to the theoretical condition $
\left\lVert b-Ax_\star \right\rVert
\le
\left\lVert b-A\tilde{x} \right\rVert
\le
\left(\frac{1+\varepsilon}{1-\varepsilon}\right)^{\xi}
\left\lVert b-Ax_\star \right\rVert,\quad
\xi=\tfrac{1}{2}.
$





**Check Orthogonality**
- When s=1, ![s=5, orthogonality](fig/A1_orthErr_s1_m501.png) |With RBG reorthogonalization ![s=1, reorthogonality](fig/A1_orthErr_s1_m501_reorth.png) |With both reorthogonalization ![s=1, reorthogonality](fig/A1_orthErr_s1_m501_reorth_both.png)
- When s=5, ![s=5, orthogonality](fig/A1_orthErr_s5_m501.png) |With RBG reorthogonalization ![s=5, reorthogonality](fig/A1_orthErr_s5_m501_reorth.png) |With both reorthogonalization ![s=5, reorthogonality](fig/A1_orthErr_s5_m501_reorth_both.png)
- When s=10, ![s=10, orthogonality](fig/A1_orthErr_s10_m501.png) |With RBG reorthogonalization ![s=10, reorthogonality](fig/A1_orthErr_s10_m501_reorth.png) |With both reorthogonalization ![s=10, reorthogonality](fig/A1_orthErr_s10_m501_reorth_both.png)
- When s=20, ![s=20, orthogonality](fig/A1_orthErr_s20_m501.png) |With both reorthogonalization ![s=20, reorthogonality](fig/A1_orthErr_s20_m501_reorth_both.png)

**Discussion:**
- After reorthogonalization, the θ-orthonormal Q generated by RBGS shows little improvement in orthogonality, although a slight enhancement can be observed in the relative residual. In contrast, the orthogonality improvement of BGS is more obvious







**When m = 1000**
| s | Relative Residual Plot | Iteration Count | Runtime (s) |
|---|------------------------|-----------------|--------------|
| 2 | ![s=2](fig/A1_relErr_iter_CI_s2_m1001.png) | 
| 4 | ![s=4](fig/A1_relErr_iter_CI_s4_m1001.png) |
| 5 | ![s=5](fig/A1_relErr_iter_CI_s5_m1001.png) |
| 8 | ![s=8](fig/A1_relErr_iter_CI_s8_m1001.png) |
| 10 | ![s=10](fig/A1_relErr_iter_CI_s10_m1001.png) | 
| 20 | ![s=20](fig/A1_relErr_iter_CI_s20_m1001.png) | 


**Discussion:**
- When s=8, BGS converged after 680 steps
- When s=10, BGS converged after 590 steps
- When s=20, BGS converged after 380 steps


---

### 2.2 Matrix A2 – Hermitian matrix

**Matrix info:** \( n = 2500, alpha = 0, lambda = logspace(0,-5,n).'\)  
**Sketch info:** \( m = 501, d = 2 * m )\  
**Converge info:** \( ctol = 1e-8)

#### ➤ Results for Step Sizes

**relative residual**  
-s=5, ![s=5](fig/A2_relErr_iter_CI_s5_m501.png) | residual after reorthogonalization ![s=5, reorthogonality](fig/A2_relErr_iter_CI_s5_m501_reorth.png) 
-s=10, ![s=10](fig/A2_relErr_iter_CI_s10_m501.png) | residual after reorthogonalization ![s=10, reorthogonality](fig/A2_relErr_iter_CI_s10_m501_reorth.png) 
-s=20, ![s=20](fig/A2_relErr_iter_CI_s20_m501.png) | residual after reorthogonalization ![s=20, reorthogonality](fig/A2_relErr_iter_CI_s20_m501_reorth.png) 

**Discussion:**
- When s=20, BGS converged after 320 steps


**Check Orthogonality**
- When s=5, ![s=5, orthogonality](fig/A2_orthErr_s5_m501.png) |With both reorthogonalization ![s=5, reorthogonality](fig/A2_orthErr_s5_m501_reorth_both.png) 
- When s=10, ![s=10, orthogonality](fig/A2_orthErr_s10_m501.png) |With both reorthogonalization ![s=10, reorthogonality](fig/A2_orthErr_s10_m501_reorth_both.png)
- When s=20, ![s=20, orthogonality](fig/A2_orthErr_s20_m501.png) |With both reorthogonalization ![s=20, reorthogonality](fig/A2_orthErr_s20_m501_reorth_both.png)


**Discussion:**









---

### 2.3 Matrix A3 – matrix with smaller condition number

**Matrix info:** \( n = 2500, alpha = 0.5, lambda = logspace(0,-1,n).'\)  
**Sketch info:** \( m = 501, d = 2 * m )\  
**Converge info:** \( ctol = 1e-8)

**relative residual**  
-s=5, ![s=5](fig/A3_relErr_iter_CI_s5_m501.png) | residual after reorthogonalization ![s=5, reorthogonality](fig/A3_relErr_iter_CI_s5_m501_reorth.png) 
-s=10, ![s=10](fig/A3_relErr_iter_CI_s10_m501.png) | residual after reorthogonalization ![s=10, reorthogonality](fig/A3_relErr_iter_CI_s10_m501_reorth.png) 
-s=20, ![s=20](fig/A3_relErr_iter_CI_s20_m501.png) | residual after reorthogonalization ![s=20, reorthogonality](fig/A3_relErr_iter_CI_s20_m501_reorth.png) 


**Observation:**
- When s=5/10, all the algorithms converge after 30 steps 
- When s=20, BGS converged after 220 steps

**Check Orthogonality**
- When s=5, ![s=5, orthogonality](fig/A3_orthErr_s5_m501.png) |With both reorthogonalization ![s=5, reorthogonality](fig/A3_orthErr_s5_m501_reorth_both.png) 
- When s=10, ![s=10, orthogonality](fig/A3_orthErr_s10_m501.png) |With both reorthogonalization ![s=10, reorthogonality](fig/A3_orthErr_s10_m501_reorth_both.png)
- When s=20, ![s=20, orthogonality](fig/A3_orthErr_s20_m501.png) |With both reorthogonalization ![s=20, reorthogonality](fig/A3_orthErr_s20_m501_reorth_both.png)

---

---
