# Notes – November 11, 2025
 
**Topic:** Discussion on Experimental Results of different orthogonalization methods

---


## 1. Overview of Experiment Setup

| Parameter | Description |
|------------|-------------|
| Solver | RBGS-GMRES, BGS-GMRES, GMRES(built-in)|
| Runs | 1 |
| Matrices Tested | SiO2, SiH4
|Krylov basis| Newton basis 
|Orthogonalization of RBGS against other blocks| rCGS, rCGS2, RGS, rMGS
|Orthogonalization of RBGS within a block| rCGS, rCGS2, RGS, rMGS, rWhitening
| Metric | Relative residual, $ \left\lVert A*x - b \right\rVert / \left\lVert b \right\rVert$ |

---

## 2. Experimental Results by Matrix

---




###  SiO2 
**Matrix info:** \( n = 155331 \) 
**step size** \( s = 5:5:50 \)  
**Sketch info:** \( CountSketch, m ≈ 1001, d = 2 * m \)      
**AOB for RBGS and BGS:** \( RGS, CGS\)    
**WB for RBGS and BGS:** \( rCGS2, CGS2\)       
**Converge info:** \( ctol = 1e-16 \)       
**Krylov basis:** \( newton basis \)

#### ➤ Different Orthogonalization methods for AOB and WB with different s
![SiO2](fig/SiO2/SiO2_relcomp_s5-s40.png)
![SiO2](fig/SiO2/SiO2_orthcomp_s5-s40.png)


|        |        |
|--------|--------|
| s = 5 ![SiO2](fig/SiO2/SiO2_relErr_iter_CI_s5_m1001_reorth_newton.png) | ![SiO2](fig/SiO2/SiO2_orthErr_s5_m1001_reorth_newton.png) |
| s = 10 ![SiO2](fig/SiO2/SiO2_relErr_iter_CI_s10_m1001_reorth_newton.png) | ![SiO2](fig/SiO2/SiO2_orthErr_s10_m1001_reorth_newton.png) |
| s = 20 ![SiO2](fig/SiO2/SiO2_relErr_iter_CI_s20_m1001_reorth_newton.png) | ![SiO2](fig/SiO2/SiO2_orthErr_s20_m1001_reorth_newton.png) |
| s = 30 ![SiO2](fig/SiO2/SiO2_relErr_iter_CI_s30_m991_reorth_newton.png) | ![SiO2](fig/SiO2/SiO2_orthErr_s30_m991_reorth_newton.png) |
| s = 40 ![SiO2](fig/SiO2/SiO2_relErr_iter_CI_s40_m1001_reorth_newton.png) | ![SiO2](fig/SiO2/SiO2_orthErr_s40_m1001_reorth_newton.png) |
| s = 50 ![SiO2](fig/SiO2/SiO2_relErr_iter_CI_s50_m1001_reorth_newton.png) | ![SiO2](fig/SiO2/SiO2_orthErr_s50_m1001_reorth_newton.png) |


**Minimum residual achieved by RBGS and BGS for SiO2 (AOB = RGS/CGS, WB = rCGS2/CGS2, m ≈ 1001, d = 2 * m)**
![SiO2](fig/SiO2/SiO2_minrel_s5-s50.png)

**Discussion:**
- When using AOB_CGS/WB_CGS2 in BGS and AOB_RGS/WB_rCGS2 in RBGS, the relative error achieved by RBGS became better than BGS; BGS are only comparable with RBGS with AOB_CGS2 as shown in the previous experiments, which are consistent with the results in the paper "RANDOMIZED GRAM–SCHMIDT PROCESS WITH APPLICATION TO GMRES" :
![paper](paperresult.png)





### 2.2 SiH4
**Matrix info:** \( n = 5041 \)  
**condition number:** \( 1.065536e+03 \).    
**Sketch info:** \( Countsketch, m ≈ 501, d = 2 * m \)       
**Converge info:** \( ctol = 1e-16 \)  
**Krylov basis:** \( newton basis \)

#### ➤ Different Orthogonalization methods for AOB and WB with different s
![SiH4](fig/SiH4/SiH4_relcomp_s5-s40.png)
![SiH4](fig/SiH4/SiH4_orthcomp_s5-s40.png)


|        |        |
|--------|--------|
| s = 5 ![SiH4](fig/SiH4/SiH4_relErr_iter_CI_s5_m501_reorth_newton.png) | ![SiH4](fig/SiH4/SiH4_orthErr_s5_m501_reorth_newton.png) |
| s = 10 ![SiH4](fig/SiH4/SiH4_relErr_iter_CI_s10_m501_reorth_newton.png) | ![SiH4](fig/SiH4/SiH4_orthErr_s10_m501_reorth_newton.png) |
| s = 20 ![SiH4](fig/SiH4/SiH4_relErr_iter_CI_s20_m501_reorth_newton.png) | ![SiH4](fig/SiH4/SiH4_orthErr_s20_m501_reorth_newton.png) |
| s = 30 ![SiH4](fig/SiH4/SiH4_relErr_iter_CI_s30_m511_reorth_newton.png) | ![SiH4](fig/SiH4/SiH4_orthErr_s30_m511_reorth_newton.png) |
| s = 40 ![SiH4](fig/SiH4/SiH4_relErr_iter_CI_s40_m521_reorth_newton.png) | ![SiH4](fig/SiH4/SiH4_orthErr_s40_m521_reorth_newton.png) |
| s = 50 ![SiH4](fig/SiH4/SiH4_relErr_iter_CI_s50_m501_reorth_newton.png) | ![SiH4](fig/SiH4/SiH4_orthErr_s50_m501_reorth_newton.png) |

**Minimum residual achieved by RBGS and BGS for SiO2 (AOB = RGS/CGS, WB = rCGS2/CGS2, m ≈ 1001, d = 2 * m)**
![SiO2](fig/SiH4/SiH4_minrel_s5-s50.png)




**RBGS is more stable with respect to the RHS b**

- With different RHSs

|     b1   |  b2      |
|--------|--------|
| s = 10 ![SiH4](fig/SiH4/test4rhs/b1s10.png) | ![SiH4](fig/SiH4/test4rhs/b2s10.png) |
| s = 20 ![SiH4](fig/SiH4/test4rhs/b1s20.png) | ![SiH4](fig/SiH4/test4rhs/b2s20.png) |
| s = 30 ![SiH4](fig/SiH4/test4rhs/b1s30.png) | ![SiH4](fig/SiH4/test4rhs/b2s30.png) |
| s = 40 ![SiH4](fig/SiH4/test4rhs/b1s40.png) | ![SiH4](fig/SiH4/test4rhs/b2s40.png) |















